{"version":3,"file":"app.js","sources":["src/app.js"],"sourcesContent":["// Here is the starting point for your application code.\n// All stuff below is just to show you how it works. You can delete all of it.\n\n// Use new ES6 modules syntax for everything.\nimport os from 'os'; // native node.js module\nimport { remote } from 'electron'; // native electron module\nimport fs from 'fs';\nvar d3 = require('d3');\n\nconst Vue = require('vue/dist/vue.common.js');\nvar musicBar = require('../src/components/musicbar').musicBar;\n\nvar Canvas = require('../src/components/canvas.js').Canvas;\n\nconst app = new Vue({\n    el: \".app\",\n    data: {\n        vizzies: [0,0,0,0,0,0,0,0],\n        canvas: new Canvas(),\n        musicInit: false,\n        state: {\n            home: true,\n            editor: false,\n        },\n        selectedShape: {\n            shape: null,\n            pos: null,\n            or: null,\n            siz: null,\n            col: null,\n        }\n    },\n    methods: {\n        musicInitialize: function() {\n            this.musicInit = true;\n        },\n        moveState: function(page) {\n            if(this.state.editor) {\n                //If we are leaving our editor state clear our svgs\n                this.canvas.clearShapeSvg();\n            }\n            for (var property in this.state) {\n                if (this.state.hasOwnProperty(property)) {\n                    console.log(property);\n                    if(property === page) {\n                        this.state[property] = true;\n                    }\n                    else {\n                        this.state[property] = false;\n                    }\n                }\n            }\n            var app = this;\n            window.setTimeout(function() {\n                if(page === 'editor') {\n                    var svg = d3.select('svg');\n                    var svgCanvas = document.getElementById('svg');\n                    app.canvas.resize(svgCanvas.clientWidth, svgCanvas.clientHeight);\n                    app.canvas.setDomCanvas(svg);\n                };\n            },0);\n            \n        },\n        selectShape: function(index) {\n            this.selectedShape.shape = this.canvas.shapes[index];\n            for (var i = 0; i < this.canvas.shapes.length; i++) {\n                this.canvas.shapes[i].isSelected = false;\n            }\n            this.canvas.shapes[index].isSelected = true;\n        },\n        toggleShapePanel: function(type) {\n\n            if(this.selectedShape[type]) {\n                this.selectedShape[type] = null;\n            }\n            else {\n                this.selectedShape[type] = 'block';\n            }\n        },\n        addShape: function() {\n            this.canvas.add();\n        }\n    },\n    mounted: function() {\n\n        //initialize audio context & audio nodes\n        var audioContext = new (window.AudioContext || window.webkitAudioContext)();\n        var source = audioContext.createMediaElementSource(document.getElementById('vizzy-audio'));\n        var analyze = audioContext.createAnalyser();\n        analyze.fftsize=2048;\n        analyze.smoothingTimeConstant=.5; //smoothing time is important for vizualization\n\n        //connect audio nodes\n        source.connect(analyze);\n        analyze.connect(audioContext.destination);\n\n        function musicData(){\n            var buffer = analyze.frequencyBinCount;\n            var data = new Uint8Array(buffer);\n            analyze.getByteFrequencyData(data);\n\n            //find the dominant frequency bin\n            var max = 0;\n            var index = -1;\n            for (var i = 0; i < buffer; i++){\n                if (data[i]>max){\n                    max = data[i];\n                    index = i;\n                }\n            }\n            //calculate the dominant frequency\n            var frequency = (index * 44100)/ 2048.0;\n\n            return {\n                'frequency': data[0]\n            };\n        }\n\n        var app = this;\n\n        function refresh(){\n            //Only runs update if we are in the editor or play mode\n            if(app.state.editor || app.state.play) {\n                app.canvas.update(musicData());\n            }\n            window.requestAnimationFrame(refresh);\n        }\n\n        window.requestAnimationFrame(refresh);\n    }\n});\n"],"names":[],"mappings":"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"}