{"version":3,"file":"app.js","sources":["src/components/musicbar.js","src/app.js"],"sourcesContent":["const Vue = require('vue/dist/vue.common.js');\nimport jsmediatags from 'jsmediatags';\nimport fs from 'fs';\nimport jetpack from 'fs-jetpack'; // module loaded from npm\nconst { dialog, app } = require('electron').remote;\n\n//Basic object for a song\nvar Song = function(data, path) {\n    this.artist = data.artist;\n    this.album = data.album;\n    this.title = data.title;\n\n    var image = data.picture;\n    if(image) {\n        var base64String = \"\";\n        for (var i = 0; i < image.data.length; i++) {\n            base64String += String.fromCharCode(image.data[i]);\n        }\n        var base64 = \"data:\" + image.format + \";base64,\" +\n                window.btoa(base64String);\n        this.picture = base64;\n    }\n    else {\n        this.picture = './img/albumPlaceHolder.png';\n    }\n    // this.number = data.track.no;\n    // this.albumImg = data.picture[0].data;\n    // this.albumImgExtension = data.picture[0].format;\n\n    this.path = path;\n}\n\nconst musicBar = Vue.component('music-bar', {\n    template: '#music-bar',\n    props: ['musicInit'],\n    data: function() {\n        return {\n            slash: (function() {\n                if(process.platform === 'darwin' || process.platform === 'linux') {\n                    return '/';\n                }\n                else return '\\\\'\n            })(),\n            flexOpt: 1,\n            musicLoaded: false,\n            audio: '',\n            isPlaying: false,\n            library: [],\n            currentSong: {\n                artist: 'No song',\n                title: 'No title',\n                picture: './img/albumPlaceHolder.png',\n                path: './'\n            },\n            index: 0,\n            percentageTime: 0,\n            dragging: \"none\",\n            directory: app.getPath('userData'),\n            userPrefs: {},\n        }\n    },\n    events: {\n        fireOpenFileExplorer: function() {\n            this.openFileExplorer();\n        }\n    },\n    methods: {\n        getMusicData: function(path) {\n            var musicBar = this;\n            return new Promise(function(resolve, reject) {\n                jsmediatags.read(path, {\n                    onSuccess: function(data) {\n                        console.log(data.tags);\n                        musicBar.library.push(new Song(data.tags, path));\n                        resolve();\n                    },\n                    onError: function(error) {\n                        console.log(':(', error.type, error.info);\n                        reject();\n                    }\n                })\n            });\n        },\n        searchDir: function(path, promises, callback) {\n            var fileList = jetpack.list(path);\n            for(var i = 0; i < fileList.length; i++) {\n                var file = path + this.slash + fileList[i];\n\n                if(fs.lstatSync(file).isDirectory()) {\n                    this.searchDir(file, promises);\n                }\n                else if(file.substr(file.length - 4) === '.mp3') {\n                    promises.push(this.getMusicData(file));\n                }\n                else {\n\n                }\n            }\n\n            if(callback) {\n                callback(promises);\n            }\n        },\n        openFileExplorer: function() {\n            var musicBar = this;\n            dialog.showOpenDialog({properties: ['openDirectory']}, function(files) {\n                var musicFolder = files[0];\n                var promises = []\n                musicBar.searchDir(musicFolder, promises, function() {\n                    Promise.all(promises).then(function() {\n                        musicBar.currentSong = musicBar.library[0];\n                        musicBar.musicLoaded = true;\n                        musicBar.flexOpt = 'none';\n                        musicBar.$emit('init');\n                        musicBar.userPrefs.library = musicBar.library;\n                        jetpack.write(musicBar.directory + musicBar.slash + 'vizzyPrefs.json', musicBar.userPrefs);\n                        console.log('done');\n                    });\n                });\n            });\n        },\n        play: function() {\n            this.audio.play();\n            this.isPlaying = true;\n        },\n        pause: function() {\n            this.audio.pause();\n            this.isPlaying = false;\n        },\n        prev: function() {\n            if(this.index === 0) {\n                this.index = this.library.length - 1;\n            }\n            else {\n                this.index--;\n            }\n            this.currentSong = this.library[this.index];\n            var musicBar = this;\n            setTimeout(function() {\n                musicBar.pause();\n                musicBar.play();\n            },100);\n        },\n        next: function() {\n            if(this.index === this.library.length - 1) {\n                this.index = 0;\n            }\n            else {\n                this.index++;\n            }\n            this.currentSong = this.library[this.index];\n            var musicBar = this;\n            setTimeout(function() {\n                musicBar.pause();\n                musicBar.play();\n            },100);\n        },\n        updateTracker: function() {\n            if(this.musicLoaded) {\n                var x = event.clientX;\n                var width = window.innerWidth;\n\n                var percentage = x/width;\n                this.percentageTime = percentage * 100;\n                this.audio.currentTime = this.audio.duration * percentage;\n            }\n        },\n        checkPrefs: function() {\n            if(jetpack.exists(this.directory + this.slash + 'vizzyPrefs.json')) {\n                var prefs = JSON.parse(jetpack.read(this.directory + this.slash + 'vizzyPrefs.json', ['jsonWithDates']));\n                console.log(prefs);\n                this.library = prefs.library;\n                this.currentSong = this.library[0];\n                this.musicLoaded = true;\n                this.flexOpt = 'none';\n                this.$emit('init');\n                console.log('preferences exist!');\n            }\n            else {\n\n                console.log('preferences do not exist');\n            }\n        }\n    },\n    mounted: function () {\n        this.checkPrefs();\n\n        var musicBar = this;\n\n        this.audio = document.getElementById('vizzy-audio');\n        this.audio.onended = function() {\n            musicBar.next();\n        }\n\n        var tracker = document.getElementById('tracker');\n        var container = document.getElementById('drag-container');\n\n        tracker.addEventListener('mousedown', function() {\n            console.log('mouse down');\n            musicBar.updateTracker();\n            musicBar.dragging = 'block';\n        }, false);\n\n        container.addEventListener('mousemove', function() {\n            if (musicBar.dragging === \"block\") {\n                musicBar.updateTracker();\n            };\n        }, false);\n\n        container.addEventListener('mouseup', function() {\n            musicBar.dragging = 'none';\n        }, false);\n\n        function updateTime() {\n            if(musicBar.isPlaying) {\n                var currentTime = musicBar.audio.currentTime;\n                var duration = musicBar.audio.duration;\n                musicBar.percentageTime = (currentTime/duration) * 100;\n            }\n            window.requestAnimationFrame(updateTime);\n        }\n\n        window.requestAnimationFrame(updateTime);\n    }\n});\n\nexport default {\n    musicBar\n}\n","// Here is the starting point for your application code.\n// All stuff below is just to show you how it works. You can delete all of it.\n\n// Use new ES6 modules syntax for everything.\nimport os from 'os'; // native node.js module\nimport { remote } from 'electron'; // native electron module\nimport fs from 'fs';\n\nconst Vue = require('vue/dist/vue.common.js');\nimport musicBar from './components/musicbar';\n\nconsole.log(musicBar);\n\nconst app = new Vue({\n    el: \".app\",\n    data: {\n        musicInit: false,\n    },\n    methods: {\n        musicInitialize: function() {\n            this.musicInit = true;\n            console.log('hi');\n        }\n    },\n    mounted: function() {\n\n    }\n});\n"],"names":["Vue","app","musicBar"],"mappings":";;;;;;;;;;AAAA,MAAMA,KAAG,GAAG,OAAO,CAAC,wBAAwB,CAAC,CAAC;AAC9C,AACA,AACA,AACA,MAAM,EAAE,MAAM,EAAE,KAAAC,KAAG,EAAE,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC;;;AAGnD,IAAI,IAAI,GAAG,SAAS,IAAI,EAAE,IAAI,EAAE;IAC5B,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;IAC1B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;IACxB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;;IAExB,IAAI,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC;IACzB,GAAG,KAAK,EAAE;QACN,IAAI,YAAY,GAAG,EAAE,CAAC;QACtB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACxC,YAAY,IAAI,MAAM,CAAC,YAAY,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;SACtD;QACD,IAAI,MAAM,GAAG,OAAO,GAAG,KAAK,CAAC,MAAM,GAAG,UAAU;gBACxC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAClC,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;KACzB;SACI;QACD,IAAI,CAAC,OAAO,GAAG,4BAA4B,CAAC;KAC/C;;;;;IAKD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;CACpB,CAAA;;AAED,MAAM,QAAQ,GAAGD,KAAG,CAAC,SAAS,CAAC,WAAW,EAAE;IACxC,QAAQ,EAAE,YAAY;IACtB,KAAK,EAAE,CAAC,WAAW,CAAC;IACpB,IAAI,EAAE,WAAW;QACb,OAAO;YACH,KAAK,EAAE,CAAC,WAAW;gBACf,GAAG,OAAO,CAAC,QAAQ,KAAK,QAAQ,IAAI,OAAO,CAAC,QAAQ,KAAK,OAAO,EAAE;oBAC9D,OAAO,GAAG,CAAC;iBACd;qBACI,OAAO,IAAI;aACnB,CAAC,EAAE;YACJ,OAAO,EAAE,CAAC;YACV,WAAW,EAAE,KAAK;YAClB,KAAK,EAAE,EAAE;YACT,SAAS,EAAE,KAAK;YAChB,OAAO,EAAE,EAAE;YACX,WAAW,EAAE;gBACT,MAAM,EAAE,SAAS;gBACjB,KAAK,EAAE,UAAU;gBACjB,OAAO,EAAE,4BAA4B;gBACrC,IAAI,EAAE,IAAI;aACb;YACD,KAAK,EAAE,CAAC;YACR,cAAc,EAAE,CAAC;YACjB,QAAQ,EAAE,MAAM;YAChB,SAAS,EAAEC,KAAG,CAAC,OAAO,CAAC,UAAU,CAAC;YAClC,SAAS,EAAE,EAAE;SAChB;KACJ;IACD,MAAM,EAAE;QACJ,oBAAoB,EAAE,WAAW;YAC7B,IAAI,CAAC,gBAAgB,EAAE,CAAC;SAC3B;KACJ;IACD,OAAO,EAAE;QACL,YAAY,EAAE,SAAS,IAAI,EAAE;YACzB,IAAI,QAAQ,GAAG,IAAI,CAAC;YACpB,OAAO,IAAI,OAAO,CAAC,SAAS,OAAO,EAAE,MAAM,EAAE;gBACzC,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE;oBACnB,SAAS,EAAE,SAAS,IAAI,EAAE;wBACtB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBACvB,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC;wBACjD,OAAO,EAAE,CAAC;qBACb;oBACD,OAAO,EAAE,SAAS,KAAK,EAAE;wBACrB,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;wBAC1C,MAAM,EAAE,CAAC;qBACZ;iBACJ,CAAC,CAAA;aACL,CAAC,CAAC;SACN;QACD,SAAS,EAAE,SAAS,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAE;YAC1C,IAAI,QAAQ,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAClC,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACrC,IAAI,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;;gBAE3C,GAAG,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,WAAW,EAAE,EAAE;oBACjC,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;iBAClC;qBACI,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,KAAK,MAAM,EAAE;oBAC7C,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC;iBAC1C;qBACI;;iBAEJ;aACJ;;YAED,GAAG,QAAQ,EAAE;gBACT,QAAQ,CAAC,QAAQ,CAAC,CAAC;aACtB;SACJ;QACD,gBAAgB,EAAE,WAAW;YACzB,IAAI,QAAQ,GAAG,IAAI,CAAC;YACpB,MAAM,CAAC,cAAc,CAAC,CAAC,UAAU,EAAE,CAAC,eAAe,CAAC,CAAC,EAAE,SAAS,KAAK,EAAE;gBACnE,IAAI,WAAW,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC3B,IAAI,QAAQ,GAAG,EAAE,CAAA;gBACjB,QAAQ,CAAC,SAAS,CAAC,WAAW,EAAE,QAAQ,EAAE,WAAW;oBACjD,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,WAAW;wBAClC,QAAQ,CAAC,WAAW,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;wBAC3C,QAAQ,CAAC,WAAW,GAAG,IAAI,CAAC;wBAC5B,QAAQ,CAAC,OAAO,GAAG,MAAM,CAAC;wBAC1B,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;wBACvB,QAAQ,CAAC,SAAS,CAAC,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC;wBAC9C,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS,GAAG,QAAQ,CAAC,KAAK,GAAG,iBAAiB,EAAE,QAAQ,CAAC,SAAS,CAAC,CAAC;wBAC3F,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;qBACvB,CAAC,CAAC;iBACN,CAAC,CAAC;aACN,CAAC,CAAC;SACN;QACD,IAAI,EAAE,WAAW;YACb,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;YAClB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;SACzB;QACD,KAAK,EAAE,WAAW;YACd,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;YACnB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SAC1B;QACD,IAAI,EAAE,WAAW;YACb,GAAG,IAAI,CAAC,KAAK,KAAK,CAAC,EAAE;gBACjB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC;aACxC;iBACI;gBACD,IAAI,CAAC,KAAK,EAAE,CAAC;aAChB;YACD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAC5C,IAAI,QAAQ,GAAG,IAAI,CAAC;YACpB,UAAU,CAAC,WAAW;gBAClB,QAAQ,CAAC,KAAK,EAAE,CAAC;gBACjB,QAAQ,CAAC,IAAI,EAAE,CAAC;aACnB,CAAC,GAAG,CAAC,CAAC;SACV;QACD,IAAI,EAAE,WAAW;YACb,GAAG,IAAI,CAAC,KAAK,KAAK,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;gBACvC,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;aAClB;iBACI;gBACD,IAAI,CAAC,KAAK,EAAE,CAAC;aAChB;YACD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAC5C,IAAI,QAAQ,GAAG,IAAI,CAAC;YACpB,UAAU,CAAC,WAAW;gBAClB,QAAQ,CAAC,KAAK,EAAE,CAAC;gBACjB,QAAQ,CAAC,IAAI,EAAE,CAAC;aACnB,CAAC,GAAG,CAAC,CAAC;SACV;QACD,aAAa,EAAE,WAAW;YACtB,GAAG,IAAI,CAAC,WAAW,EAAE;gBACjB,IAAI,CAAC,GAAG,KAAK,CAAC,OAAO,CAAC;gBACtB,IAAI,KAAK,GAAG,MAAM,CAAC,UAAU,CAAC;;gBAE9B,IAAI,UAAU,GAAG,CAAC,CAAC,KAAK,CAAC;gBACzB,IAAI,CAAC,cAAc,GAAG,UAAU,GAAG,GAAG,CAAC;gBACvC,IAAI,CAAC,KAAK,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;aAC7D;SACJ;QACD,UAAU,EAAE,WAAW;YACnB,GAAG,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,GAAG,iBAAiB,CAAC,EAAE;gBAChE,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,GAAG,iBAAiB,EAAE,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;gBACzG,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;gBACnB,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;gBAC7B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;gBACnC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;gBACxB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;gBACtB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;gBACnB,OAAO,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;aACrC;iBACI;;gBAED,OAAO,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;aAC3C;SACJ;KACJ;IACD,OAAO,EAAE,YAAY;QACjB,IAAI,CAAC,UAAU,EAAE,CAAC;;QAElB,IAAI,QAAQ,GAAG,IAAI,CAAC;;QAEpB,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;QACpD,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,WAAW;YAC5B,QAAQ,CAAC,IAAI,EAAE,CAAC;SACnB,CAAA;;QAED,IAAI,OAAO,GAAG,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QACjD,IAAI,SAAS,GAAG,QAAQ,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC;;QAE1D,OAAO,CAAC,gBAAgB,CAAC,WAAW,EAAE,WAAW;YAC7C,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;YAC1B,QAAQ,CAAC,aAAa,EAAE,CAAC;YACzB,QAAQ,CAAC,QAAQ,GAAG,OAAO,CAAC;SAC/B,EAAE,KAAK,CAAC,CAAC;;QAEV,SAAS,CAAC,gBAAgB,CAAC,WAAW,EAAE,WAAW;YAC/C,IAAI,QAAQ,CAAC,QAAQ,KAAK,OAAO,EAAE;gBAC/B,QAAQ,CAAC,aAAa,EAAE,CAAC;aAC5B,AAAC;SACL,EAAE,KAAK,CAAC,CAAC;;QAEV,SAAS,CAAC,gBAAgB,CAAC,SAAS,EAAE,WAAW;YAC7C,QAAQ,CAAC,QAAQ,GAAG,MAAM,CAAC;SAC9B,EAAE,KAAK,CAAC,CAAC;;QAEV,SAAS,UAAU,GAAG;YAClB,GAAG,QAAQ,CAAC,SAAS,EAAE;gBACnB,IAAI,WAAW,GAAG,QAAQ,CAAC,KAAK,CAAC,WAAW,CAAC;gBAC7C,IAAI,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC;gBACvC,QAAQ,CAAC,cAAc,GAAG,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,GAAG,CAAC;aAC1D;YACD,MAAM,CAAC,qBAAqB,CAAC,UAAU,CAAC,CAAC;SAC5C;;QAED,MAAM,CAAC,qBAAqB,CAAC,UAAU,CAAC,CAAC;KAC5C;CACJ,CAAC,CAAC;;AAEH,iBAAe;IACX,QAAQ;CACX,CAAA;;ACpOD;;;;AAIA,AACA,AACA,AAEA,MAAM,GAAG,GAAG,OAAO,CAAC,wBAAwB,CAAC,CAAC;AAC9C,AAEA,OAAO,CAAC,GAAG,CAACC,UAAQ,CAAC,CAAC;;AAEtB,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC;IAChB,EAAE,EAAE,MAAM;IACV,IAAI,EAAE;QACF,SAAS,EAAE,KAAK;KACnB;IACD,OAAO,EAAE;QACL,eAAe,EAAE,WAAW;YACxB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACtB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;SACrB;KACJ;IACD,OAAO,EAAE,WAAW;;KAEnB;CACJ,CAAC,CAAC"}