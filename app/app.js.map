{"version":3,"file":"app.js","sources":["src/app.js"],"sourcesContent":["// Here is the starting point for your application code.\n// All stuff below is just to show you how it works. You can delete all of it.\n\n// Use new ES6 modules syntax for everything.\nimport os from 'os'; // native node.js module\nvar remote = require('electron').remote; // native electron module\nvar electronApp = require('electron').remote.app\nimport fs from 'fs';\nvar jetpack = require('fs-jetpack');\nvar d3 = require('d3');\n\nconst Vue = require('vue/dist/vue.common.js');\nvar musicBar = require('../src/components/musicbar').musicBar;\n\nvar Canvas = require('../src/components/canvas.js').Canvas;\nvar Shape = require('../src/components/shape.js').Shape;\nvar musicData = require('../src/components/musicdata.js').musicData;\n\nvar SLASH = (function() {\n        if(process.platform === 'darwin' || process.platform === 'linux') {\n            return '/';\n        }\n        else return '\\\\'\n})();\n\nvar VIZZY_PATH = electronApp.getPath('userData') + SLASH + 'vizzies';\n\nconst app = new Vue({\n    el: \".app\",\n    data: {\n        directoryCheck: jetpack.exists(VIZZY_PATH),\n        vizzyDirectory: '',\n        vizzies: [],\n        vizzy: {\n            id: \"Placeholder\",\n            canvas: new Canvas(),\n        },\n        musicInit: false,\n        state: {\n            home: true,\n            editor: false,\n            player: false\n        },\n        selectedShape: {\n            shape: null,\n            pos: null,\n            or: null,\n            siz: null,\n            col: null,\n            minColor: null,\n            maxColor: null\n        },\n        editor: {\n            editId: false,\n            minColorSelected: true\n        }\n    },\n    methods: {\n        musicInitialize: function() {\n            this.musicInit = true;\n        },\n        moveState: function(page, index) {\n            if(this.state.editor || this.state.player) {\n                //If we are leaving our editor/player state clear our svgs\n                this.vizzy.canvas.clearShapeSvg();\n            }\n\n            if(this.state.editor) {\n                //Save the vizzy if we are moving away from the editor back home.\n                this.saveVizzy();\n            }\n\n            for (var property in this.state) {\n                if (this.state.hasOwnProperty(property)) {\n                    if(property === page) {\n                        this.state[property] = true;\n                    }\n                    else {\n                        this.state[property] = false;\n                    }\n                }\n            }\n            var app = this;\n            window.setTimeout(function() {\n                if(page === 'editor' || page === 'player') {\n                    //Reset our selected shape\n                    app.selectedShape = {\n                        shape: null,\n                        pos: null,\n                        or: null,\n                        siz: null,\n                        col: null,\n                        minColor: null,\n                        maxColor: null\n                    };\n                    //If we are loading a saved vizzy\n                    if(index === 0 || index) {\n                        //Set our vizzy\n                        app.setVizzy(index);\n                    }\n                    //If we are loading a new vizzy\n                    else {\n                        app.setVizzy(null, true);\n                    }\n                };\n            },0);\n        },\n        newVizzy: function() {\n            this.vizzy.id = 'Placeholder' + this.vizzies.length;\n        },\n        saveVizzy: function() {\n            //Remove our existing file, and save the new one\n            jetpack.remove(VIZZY_PATH + SLASH + this.vizzy.id + '.json');\n            jetpack.write(VIZZY_PATH + SLASH + this.vizzy.id + '.json', this.vizzy);\n            //Update our vizzy list so it is reflected on the home page\n            this.updateVizzyList();\n        },\n        setVizzy: function(index, newVizzy) {\n            //Create a new canvas, and set it's ID to our selected Vizzies ID\n            this.vizzy.canvas = new Canvas();\n\n            if (!newVizzy) {\n                this.vizzy.id = this.vizzies[index].id;\n            }\n\n            //Grabbing our on screen canvas, and resizing and setting the DOM of our canvas class\n            var svg = d3.select('svg');\n            var svgCanvas = document.getElementById('svg');\n            app.vizzy.canvas.resize(svgCanvas.clientWidth, svgCanvas.clientHeight);\n            app.vizzy.canvas.setDomCanvas(svg);\n\n            //Runs through all of the saved shapes and adds new shapes to our canvas. Also copies our saved shapes attributes to our new shapes\n            for(var i = 0; i < this.vizzies[index].canvas.shapes.length; i++) {\n                this.vizzy.canvas.add();\n                for (var property in this.vizzies[index].canvas.shapes[i]) {\n                    if (this.vizzies[index].canvas.shapes[i].hasOwnProperty(property)) {\n                        this.vizzy.canvas.shapes[i][property] = this.vizzies[index].canvas.shapes[i][property];\n                    }\n                }\n            }\n        },\n        updateVizzyList: function() {\n            //Finds our stored vizzies and sets them to our vizzies array\n            var foundVizzies = jetpack.list(VIZZY_PATH);\n            var parsedVizzies = [];\n            if (foundVizzies.length === 0) {\n                console.log('no vizzies found');\n            }\n            else {\n                for(var i = 0; i < foundVizzies.length; i++) {\n                    parsedVizzies.push(JSON.parse(jetpack.read(VIZZY_PATH + SLASH + foundVizzies[i])));\n                }\n            }\n            this.vizzies = parsedVizzies;\n        },\n        selectShape: function(index) {\n            this.selectedShape.shape = this.vizzy.canvas.shapes[index];\n            this.setColor();\n            for (var i = 0; i < this.vizzy.canvas.shapes.length; i++) {\n                this.vizzy.canvas.shapes[i].isSelected = false;\n            }\n            this.vizzy.canvas.shapes[index].isSelected = true;\n        },\n        toggleShapePanel: function(type) {\n\n            if(this.selectedShape[type]) {\n                this.selectedShape[type] = null;\n            }\n            else {\n                this.selectedShape[type] = 'block';\n            }\n        },\n        addShape: function() {\n            this.vizzy.canvas.add();\n        },\n        setColor: function() {\n            var minRed = this.selectedShape.shape.minColor.red;\n            var minGreen = this.selectedShape.shape.minColor.green;\n            var minBlue = this.selectedShape.shape.minColor.blue;\n\n            this.selectedShape.minColor = \"rgb(\" + minRed + ',' + minGreen + ',' + minBlue + ')';\n\n            var maxRed = this.selectedShape.shape.maxColor.red;\n            var maxGreen = this.selectedShape.shape.maxColor.green;\n            var maxBlue = this.selectedShape.shape.maxColor.blue;\n\n            this.selectedShape.maxColor = \"rgb(\" + maxRed + ',' + maxGreen + ',' + maxBlue + ')';\n\n            console.log(this.selectedShape.minColor);\n        }\n    },\n    mounted: function() {\n        if (this.directoryCheck) {\n            this.updateVizzyList();\n        }\n        else {\n            jetpack.dir(VIZZY_PATH);\n            this.vizzyDirectory = VIZZY_PATH;\n        }\n\n        //initialize audio context & audio nodes\n        var audioContext = new (window.AudioContext || window.webkitAudioContext)();\n        var source = audioContext.createMediaElementSource(document.getElementById('vizzy-audio'));\n        var analyze = audioContext.createAnalyser();\n        analyze.fftsize=1024;\n        analyze.smoothingTimeConstant=.5; //smoothing time is important for vizualization\n\n        //connect audio nodes\n        source.connect(analyze);\n        analyze.connect(audioContext.destination);\n\n        var mdata = new musicData(audioContext, analyze);\n\n        var app = this;\n\n        function refresh(){\n            //Only runs update if we are in the editor or play mode\n            if(app.state.editor || app.state.player) {\n                mdata.update().then((ret) => {\n                    app.vizzy.canvas.update(ret);\n                });\n            }\n            window.requestAnimationFrame(refresh);\n        }\n\n        window.requestAnimationFrame(refresh);\n    }\n});\n"],"names":[],"mappings":"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"}