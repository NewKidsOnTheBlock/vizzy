{"version":3,"file":"app.js","sources":["src/app.js"],"sourcesContent":["// Here is the starting point for your application code.\r\n// All stuff below is just to show you how it works. You can delete all of it.\r\n\r\n// Use new ES6 modules syntax for everything.\r\nimport os from 'os'; // native node.js module\r\nimport { remote } from 'electron'; // native electron module\r\nimport fs from 'fs';\r\nvar d3 = require('d3');\r\n\r\nconst Vue = require('vue/dist/vue.common.js');\r\nvar musicBar = require('../src/components/musicbar').musicBar;\r\n\r\nvar Canvas = require('../src/components/canvas.js').Canvas;\r\n\r\nconst app = new Vue({\r\n    el: \".app\",\r\n    data: {\r\n        vizzies: [0,0,0,0,0,0,0,0],\r\n        canvas: new Canvas(),\r\n        musicInit: false,\r\n        state: {\r\n            home: true,\r\n            editor: false,\r\n            player: false\r\n        },\r\n        selectedShape: {\r\n            shape: null,\r\n            pos: null,\r\n            or: null,\r\n            siz: null,\r\n            col: null,\r\n        }\r\n    },\r\n    methods: {\r\n        musicInitialize: function() {\r\n            this.musicInit = true;\r\n        },\r\n        moveState: function(page) {\r\n            if(this.state.editor || this.state.player) {\r\n                //If we are leaving our editor/player state clear our svgs\r\n                this.canvas.clearShapeSvg();\r\n            }\r\n            for (var property in this.state) {\r\n                if (this.state.hasOwnProperty(property)) {\r\n                    console.log(property);\r\n                    if(property === page) {\r\n                        this.state[property] = true;\r\n                    }\r\n                    else {\r\n                        this.state[property] = false;\r\n                    }\r\n                }\r\n            }\r\n            var app = this;\r\n            window.setTimeout(function() {\r\n                if(page === 'editor' || page === 'player') {\r\n                    var svg = d3.select('svg');\r\n                    var svgCanvas = document.getElementById('svg');\r\n                    app.canvas.resize(svgCanvas.clientWidth, svgCanvas.clientHeight);\r\n                    app.canvas.setDomCanvas(svg);\r\n                };\r\n            },0);\r\n            \r\n        },\r\n        selectShape: function(index) {\r\n            this.selectedShape.shape = this.canvas.shapes[index];\r\n            for (var i = 0; i < this.canvas.shapes.length; i++) {\r\n                this.canvas.shapes[i].isSelected = false;\r\n            }\r\n            this.canvas.shapes[index].isSelected = true;\r\n        },\r\n        toggleShapePanel: function(type) {\r\n\r\n            if(this.selectedShape[type]) {\r\n                this.selectedShape[type] = null;\r\n            }\r\n            else {\r\n                this.selectedShape[type] = 'block';\r\n            }\r\n        },\r\n        addShape: function() {\r\n            this.canvas.add();\r\n        }\r\n    },\r\n    mounted: function() {\r\n\r\n        //initialize audio context & audio nodes\r\n        var audioContext = new (window.AudioContext || window.webkitAudioContext)();\r\n        var source = audioContext.createMediaElementSource(document.getElementById('vizzy-audio'));\r\n        var analyze = audioContext.createAnalyser();\r\n        analyze.fftsize=2048;\r\n        analyze.smoothingTimeConstant=.5; //smoothing time is important for vizualization\r\n\r\n        //connect audio nodes\r\n        source.connect(analyze);\r\n        analyze.connect(audioContext.destination);\r\n\r\n        function musicData(){\r\n            var buffer = analyze.frequencyBinCount;\r\n            var data = new Uint8Array(buffer);\r\n            analyze.getByteFrequencyData(data);\r\n\r\n            //find the dominant frequency bin\r\n            var max = 0;\r\n            var index = -1;\r\n            for (var i = 0; i < buffer; i++){\r\n                if (data[i]>max){\r\n                    max = data[i];\r\n                    index = i;\r\n                }\r\n            }\r\n            //calculate the dominant frequency\r\n            var frequency = (index * 44100)/ 2048.0;\r\n\r\n            return {\r\n                'frequency': data[0]\r\n            };\r\n        }\r\n\r\n        var app = this;\r\n\r\n        function refresh(){\r\n            //Only runs update if we are in the editor or play mode\r\n            if(app.state.editor || app.state.player) {\r\n                app.canvas.update(musicData());\r\n            }\r\n            window.requestAnimationFrame(refresh);\r\n        }\r\n\r\n        window.requestAnimationFrame(refresh);\r\n    }\r\n});\r\n"],"names":[],"mappings":"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"}