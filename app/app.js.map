{"version":3,"file":"app.js","sources":["src/app.js"],"sourcesContent":["//Grabbing our requirements from other files\r\nvar remote = require('electron').remote; // native electron module\r\nvar electronApp = require('electron').remote.app\r\nvar fs = require('fs');\r\nvar jetpack = require('fs-jetpack');\r\nvar d3 = require('d3');\r\nvar SvgSaver = require('../src/components/svgToPng.js').SvgSaver;\r\nconsole.log(SvgSaver);\r\n\r\n//Vue and its components\r\nvar Vue = require('vue/dist/vue.common.js');\r\nvar musicBar = require('../src/components/musicbar').musicBar;\r\n\r\n//Our three main classes\r\nvar Canvas = require('../src/components/canvas.js').Canvas;\r\nvar Shape = require('../src/components/shape.js').Shape;\r\nvar musicData = require('../src/components/musicdata.js').musicData;\r\n\r\n//Creating a global variable for a slash to append to our paths\r\nvar SLASH = (function() {\r\n        if(process.platform === 'darwin' || process.platform === 'linux') {\r\n            return '/';\r\n        }\r\n        else return '\\\\'\r\n})();\r\n\r\n//Path to our Vizzies\r\nvar VIZZY_PATH = electronApp.getPath('userData') + SLASH + 'vizzies';\r\n\r\n//Creating a function for Vue for swapping places\r\nVue.swap = function(arr, x, y) {\r\n   var origin = arr[x]\r\n   arr.splice(x, 1, arr[y])\r\n   Vue.set(arr, y, origin)\r\n}\r\n\r\nvar app = new Vue({\r\n    el: \".app\",\r\n    data: {\r\n        directoryCheck: jetpack.exists(VIZZY_PATH),\r\n        vizzyDirectory: '',\r\n        vizzies: [],\r\n        vizzy: {\r\n            id: \"Placeholder\",\r\n            canvas: new Canvas(),\r\n        },\r\n        musicInit: false,\r\n        state: {\r\n            home: true,\r\n            editor: false,\r\n            player: false\r\n        },\r\n        selectedShape: {\r\n            shape: null,\r\n            typ: null,\r\n            pos: null,\r\n            or: null,\r\n            siz: null,\r\n            col: null,\r\n            minColor: null,\r\n            maxColor: null\r\n        },\r\n        editor: {\r\n            editId: false,\r\n            minColorSelected: true\r\n        },\r\n        deleting: false,\r\n        creating: false,\r\n        newVizzyName: ''\r\n    },\r\n    methods: {\r\n        musicInitialize: function() {\r\n            this.musicInit = true;\r\n        },\r\n        moveState: function(page, index) {\r\n            // if(this.state.editor) {\r\n            //     //Save the vizzy if we are moving away from the editor back home.\r\n            //     this.saveVizzy();\r\n                \r\n            // }\r\n\r\n            for (var property in this.state) {\r\n                if (this.state.hasOwnProperty(property)) {\r\n                    if(property === page) {\r\n                        this.state[property] = true;\r\n                    }\r\n                    else {\r\n                        this.state[property] = false;\r\n                    }\r\n                }\r\n            }\r\n            var app = this;\r\n            window.setTimeout(function() {\r\n                if(page === 'editor' || page === 'player') {\r\n                    //Reset our selected shape\r\n                    app.selectedShape = {\r\n                        shape: null,\r\n                        typ: null,\r\n                        pos: null,\r\n                        or: null,\r\n                        siz: null,\r\n                        col: null,\r\n                        minColor: null,\r\n                        maxColor: null\r\n                    };\r\n                    //If we are loading a saved vizzy\r\n                    if(index === 0 || index) {\r\n                        //Set our vizzy\r\n                        app.setVizzy(index);\r\n                    }\r\n                    //If we are loading a new vizzy\r\n                    else {\r\n                        app.setVizzy(null, true);\r\n                    }\r\n\r\n                };\r\n            },0);\r\n        },\r\n        newVizzy: function() {\r\n            this.vizzy.id = this.newVizzyName || 'Placeholder' + this.vizzies.length;\r\n            this.moveState('editor');\r\n            this.creating = false;\r\n        },\r\n        saveVizzy: function() {\r\n            this.vizzy.pic = this.vizzy.canvas.domCanvas.toDataURL('png');\r\n            //Remove our existing file, and save the new one\r\n            jetpack.remove(VIZZY_PATH + SLASH + this.vizzy.id + '.json');\r\n            jetpack.write(VIZZY_PATH + SLASH + this.vizzy.id + '.json', this.vizzy);\r\n            //Update our vizzy list so it is reflected on the home page\r\n            this.updateVizzyList();\r\n            this.moveState('home');\r\n        },\r\n        deleteVizzy: function() {\r\n            //Remove our existing file, and save the new one\r\n            jetpack.remove(VIZZY_PATH + SLASH + this.deleting + '.json');\r\n            this.updateVizzyList();\r\n            this.deleting = false;\r\n        },\r\n        setVizzy: function(index, newVizzy) {\r\n            //Create a new canvas, and set it's ID to our selected Vizzies ID\r\n            this.vizzy.canvas = new Canvas();\r\n\r\n            if (!newVizzy) {\r\n                this.vizzy.id = this.vizzies[index].id;\r\n            }\r\n\r\n            //Grabbing our on screen canvas, and resizing and setting the DOM of our canvas class\r\n            var canvas = document.getElementById('canvas');\r\n            console.log(canvas.clientWidth);\r\n            var width = canvas.clientWidth;\r\n            var height = canvas.clientHeight;\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n            app.vizzy.canvas.resize(canvas.clientWidth, canvas.clientHeight);\r\n            app.vizzy.canvas.setDomCanvas(canvas);\r\n\r\n            //Runs through all of the saved shapes and adds new shapes to our canvas. Also copies our saved shapes attributes to our new shapes\r\n            for(var i = 0; i < this.vizzies[index].canvas.shapes.length; i++) {\r\n                this.vizzy.canvas.add();\r\n                for (var property in this.vizzies[index].canvas.shapes[i]) {\r\n                    if (this.vizzies[index].canvas.shapes[i].hasOwnProperty(property)) {\r\n                        this.vizzy.canvas.shapes[i][property] = this.vizzies[index].canvas.shapes[i][property];\r\n                    }\r\n                }\r\n                this.vizzy.canvas.shapes[i].switchShapeType();\r\n            }\r\n        },\r\n        updateVizzyList: function() {\r\n            //Finds our stored vizzies and sets them to our vizzies array\r\n            var foundVizzies = jetpack.list(VIZZY_PATH);\r\n            var parsedVizzies = [];\r\n            if (foundVizzies.length === 0) {\r\n                console.log('no vizzies found');\r\n            }\r\n            else {\r\n                for(var i = 0; i < foundVizzies.length; i++) {\r\n                    parsedVizzies.push(JSON.parse(jetpack.read(VIZZY_PATH + SLASH + foundVizzies[i])));\r\n                }\r\n            }\r\n            this.vizzies = parsedVizzies;\r\n        },\r\n        resolvePic: function(vizzy) {\r\n            return 'url(' + vizzy.pic || '' + ')';\r\n        },\r\n        selectShape: function(index) {\r\n            this.selectedShape.shape = this.vizzy.canvas.shapes[index];\r\n            this.setColor();\r\n            for (var i = 0; i < this.vizzy.canvas.shapes.length; i++) {\r\n                this.vizzy.canvas.shapes[i].isSelected = false;\r\n            }\r\n            this.vizzy.canvas.shapes[index].isSelected = true;\r\n        },\r\n        moveBack: function(index) {\r\n            this.selectedShape.shape = null;\r\n            if(index !== 0) {\r\n                Vue.swap(this.vizzy.canvas.shapes, index, index-1);\r\n                this.selectShape(index-1);\r\n            }\r\n            this.vizzy.canvas.rearrangeShapes();\r\n            \r\n        },\r\n        moveForward: function(index) {\r\n            this.selectedShape.shape = null;\r\n            if(index !== this.vizzy.canvas.shapes.length - 1) {\r\n                Vue.swap(this.vizzy.canvas.shapes, index, index+1);\r\n                this.selectShape(index+1);\r\n            }\r\n            this.vizzy.canvas.rearrangeShapes();\r\n        },\r\n        toggleShapePanel: function(type) {\r\n\r\n            if(this.selectedShape[type]) {\r\n                this.selectedShape[type] = null;\r\n            }\r\n            else {\r\n                this.selectedShape[type] = 'block';\r\n            }\r\n        },\r\n        addShape: function() {\r\n            this.vizzy.canvas.add();\r\n        },\r\n        setColor: function() {\r\n            var minRed = this.selectedShape.shape.minColor.red;\r\n            var minGreen = this.selectedShape.shape.minColor.green;\r\n            var minBlue = this.selectedShape.shape.minColor.blue;\r\n\r\n            this.selectedShape.minColor = \"rgb(\" + minRed + ',' + minGreen + ',' + minBlue + ')';\r\n\r\n            var maxRed = this.selectedShape.shape.maxColor.red;\r\n            var maxGreen = this.selectedShape.shape.maxColor.green;\r\n            var maxBlue = this.selectedShape.shape.maxColor.blue;\r\n\r\n            this.selectedShape.maxColor = \"rgb(\" + maxRed + ',' + maxGreen + ',' + maxBlue + ')';\r\n        }\r\n    },\r\n    mounted: function() {\r\n        if (this.directoryCheck) {\r\n            this.updateVizzyList();\r\n        }\r\n        else {\r\n            jetpack.dir(VIZZY_PATH);\r\n            this.vizzyDirectory = VIZZY_PATH;\r\n        }\r\n\r\n        //initialize audio context and create musicdata \r\n        var audioContext = new (window.AudioContext || window.webkitAudioContext)();\r\n        var mdata = new musicData(audioContext);\r\n\r\n        var app = this;\r\n\r\n        function refresh(){\r\n            //Only runs update if we are in the editor or play mode\r\n            if(app.state.editor || app.state.player) {\r\n                mdata.update().then((ret) => {\r\n                    app.vizzy.canvas.clear();\r\n                    app.vizzy.canvas.update(ret);\r\n                });\r\n            }\r\n            window.requestAnimationFrame(refresh);\r\n        }\r\n\r\n        window.requestAnimationFrame(refresh);\r\n    }\r\n});\r\n"],"names":[],"mappings":";;AAAA;AACA,IAAI,MAAM,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC;AACxC,IAAI,WAAW,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC,GAAG,CAAA;AAChD,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;AACvB,IAAI,OAAO,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACpC,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;AACvB,IAAI,QAAQ,GAAG,OAAO,CAAC,+BAA+B,CAAC,CAAC,QAAQ,CAAC;AACjE,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;;;AAGtB,IAAI,GAAG,GAAG,OAAO,CAAC,wBAAwB,CAAC,CAAC;AAC5C,IAAI,QAAQ,GAAG,OAAO,CAAC,4BAA4B,CAAC,CAAC,QAAQ,CAAC;;;AAG9D,IAAI,MAAM,GAAG,OAAO,CAAC,6BAA6B,CAAC,CAAC,MAAM,CAAC;AAC3D,IAAI,KAAK,GAAG,OAAO,CAAC,4BAA4B,CAAC,CAAC,KAAK,CAAC;AACxD,IAAI,SAAS,GAAG,OAAO,CAAC,gCAAgC,CAAC,CAAC,SAAS,CAAC;;;AAGpE,IAAI,KAAK,GAAG,CAAC,WAAW;QAChB,GAAG,OAAO,CAAC,QAAQ,KAAK,QAAQ,IAAI,OAAO,CAAC,QAAQ,KAAK,OAAO,EAAE;YAC9D,OAAO,GAAG,CAAC;SACd;aACI,OAAO,IAAI;CACvB,CAAC,EAAE,CAAC;;;AAGL,IAAI,UAAU,GAAG,WAAW,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,KAAK,GAAG,SAAS,CAAC;;;AAGrE,GAAG,CAAC,IAAI,GAAG,SAAS,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE;GAC5B,IAAI,MAAM,GAAG,GAAG,CAAC,CAAC,CAAC,CAAA;GACnB,GAAG,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;GACxB,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,EAAE,MAAM,CAAC,CAAA;CACzB,CAAA;;AAED,IAAI,GAAG,GAAG,IAAI,GAAG,CAAC;IACd,EAAE,EAAE,MAAM;IACV,IAAI,EAAE;QACF,cAAc,EAAE,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC;QAC1C,cAAc,EAAE,EAAE;QAClB,OAAO,EAAE,EAAE;QACX,KAAK,EAAE;YACH,EAAE,EAAE,aAAa;YACjB,MAAM,EAAE,IAAI,MAAM,EAAE;SACvB;QACD,SAAS,EAAE,KAAK;QAChB,KAAK,EAAE;YACH,IAAI,EAAE,IAAI;YACV,MAAM,EAAE,KAAK;YACb,MAAM,EAAE,KAAK;SAChB;QACD,aAAa,EAAE;YACX,KAAK,EAAE,IAAI;YACX,GAAG,EAAE,IAAI;YACT,GAAG,EAAE,IAAI;YACT,EAAE,EAAE,IAAI;YACR,GAAG,EAAE,IAAI;YACT,GAAG,EAAE,IAAI;YACT,QAAQ,EAAE,IAAI;YACd,QAAQ,EAAE,IAAI;SACjB;QACD,MAAM,EAAE;YACJ,MAAM,EAAE,KAAK;YACb,gBAAgB,EAAE,IAAI;SACzB;QACD,QAAQ,EAAE,KAAK;QACf,QAAQ,EAAE,KAAK;QACf,YAAY,EAAE,EAAE;KACnB;IACD,OAAO,EAAE;QACL,eAAe,EAAE,WAAW;YACxB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;SACzB;QACD,SAAS,EAAE,SAAS,IAAI,EAAE,KAAK,EAAE;;;;;;;YAO7B,KAAK,IAAI,QAAQ,IAAI,IAAI,CAAC,KAAK,EAAE;gBAC7B,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,CAAC,EAAE;oBACrC,GAAG,QAAQ,KAAK,IAAI,EAAE;wBAClB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC;qBAC/B;yBACI;wBACD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,KAAK,CAAC;qBAChC;iBACJ;aACJ;YACD,IAAI,GAAG,GAAG,IAAI,CAAC;YACf,MAAM,CAAC,UAAU,CAAC,WAAW;gBACzB,GAAG,IAAI,KAAK,QAAQ,IAAI,IAAI,KAAK,QAAQ,EAAE;;oBAEvC,GAAG,CAAC,aAAa,GAAG;wBAChB,KAAK,EAAE,IAAI;wBACX,GAAG,EAAE,IAAI;wBACT,GAAG,EAAE,IAAI;wBACT,EAAE,EAAE,IAAI;wBACR,GAAG,EAAE,IAAI;wBACT,GAAG,EAAE,IAAI;wBACT,QAAQ,EAAE,IAAI;wBACd,QAAQ,EAAE,IAAI;qBACjB,CAAC;;oBAEF,GAAG,KAAK,KAAK,CAAC,IAAI,KAAK,EAAE;;wBAErB,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;qBACvB;;yBAEI;wBACD,GAAG,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;qBAC5B;;iBAEJ,AAAC;aACL,CAAC,CAAC,CAAC,CAAC;SACR;QACD,QAAQ,EAAE,WAAW;YACjB,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,IAAI,CAAC,YAAY,IAAI,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;YACzE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;YACzB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;SACzB;QACD,SAAS,EAAE,WAAW;YAClB,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;;YAE9D,OAAO,CAAC,MAAM,CAAC,UAAU,GAAG,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,OAAO,CAAC,CAAC;YAC7D,OAAO,CAAC,KAAK,CAAC,UAAU,GAAG,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;;YAExE,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;SAC1B;QACD,WAAW,EAAE,WAAW;;YAEpB,OAAO,CAAC,MAAM,CAAC,UAAU,GAAG,KAAK,GAAG,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,CAAC;YAC7D,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;SACzB;QACD,QAAQ,EAAE,SAAS,KAAK,EAAE,QAAQ,EAAE;;YAEhC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,MAAM,EAAE,CAAC;;YAEjC,IAAI,CAAC,QAAQ,EAAE;gBACX,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC;aAC1C;;;YAGD,IAAI,MAAM,GAAG,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;YAC/C,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;YAChC,IAAI,KAAK,GAAG,MAAM,CAAC,WAAW,CAAC;YAC/B,IAAI,MAAM,GAAG,MAAM,CAAC,YAAY,CAAC;YACjC,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC;YACrB,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC;YACvB,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,WAAW,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;YACjE,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;;;YAGtC,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAC9D,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;gBACxB,KAAK,IAAI,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;oBACvD,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,QAAQ,CAAC,EAAE;wBAC/D,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;qBAC1F;iBACJ;gBACD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,eAAe,EAAE,CAAC;aACjD;SACJ;QACD,eAAe,EAAE,WAAW;;YAExB,IAAI,YAAY,GAAG,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAC5C,IAAI,aAAa,GAAG,EAAE,CAAC;YACvB,IAAI,YAAY,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC3B,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;aACnC;iBACI;gBACD,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBACzC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,GAAG,KAAK,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;iBACtF;aACJ;YACD,IAAI,CAAC,OAAO,GAAG,aAAa,CAAC;SAChC;QACD,UAAU,EAAE,SAAS,KAAK,EAAE;YACxB,OAAO,MAAM,GAAG,KAAK,CAAC,GAAG,IAAI,EAAE,GAAG,GAAG,CAAC;SACzC;QACD,WAAW,EAAE,SAAS,KAAK,EAAE;YACzB,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAC3D,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACtD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,UAAU,GAAG,KAAK,CAAC;aAClD;YACD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC;SACrD;QACD,QAAQ,EAAE,SAAS,KAAK,EAAE;YACtB,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,IAAI,CAAC;YAChC,GAAG,KAAK,KAAK,CAAC,EAAE;gBACZ,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;gBACnD,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;aAC7B;YACD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC;;SAEvC;QACD,WAAW,EAAE,SAAS,KAAK,EAAE;YACzB,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,IAAI,CAAC;YAChC,GAAG,KAAK,KAAK,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC9C,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;gBACnD,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;aAC7B;YACD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC;SACvC;QACD,gBAAgB,EAAE,SAAS,IAAI,EAAE;;YAE7B,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE;gBACzB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;aACnC;iBACI;gBACD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;aACtC;SACJ;QACD,QAAQ,EAAE,WAAW;YACjB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;SAC3B;QACD,QAAQ,EAAE,WAAW;YACjB,IAAI,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC;YACnD,IAAI,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC;YACvD,IAAI,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC;;YAErD,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,MAAM,GAAG,MAAM,GAAG,GAAG,GAAG,QAAQ,GAAG,GAAG,GAAG,OAAO,GAAG,GAAG,CAAC;;YAErF,IAAI,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC;YACnD,IAAI,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC;YACvD,IAAI,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC;;YAErD,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,MAAM,GAAG,MAAM,GAAG,GAAG,GAAG,QAAQ,GAAG,GAAG,GAAG,OAAO,GAAG,GAAG,CAAC;SACxF;KACJ;IACD,OAAO,EAAE,WAAW;QAChB,IAAI,IAAI,CAAC,cAAc,EAAE;YACrB,IAAI,CAAC,eAAe,EAAE,CAAC;SAC1B;aACI;YACD,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;YACxB,IAAI,CAAC,cAAc,GAAG,UAAU,CAAC;SACpC;;;QAGD,IAAI,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,kBAAkB,CAAC,EAAE,CAAC;QAC5E,IAAI,KAAK,GAAG,IAAI,SAAS,CAAC,YAAY,CAAC,CAAC;;QAExC,IAAI,GAAG,GAAG,IAAI,CAAC;;QAEf,SAAS,OAAO,EAAE;;YAEd,GAAG,GAAG,CAAC,KAAK,CAAC,MAAM,IAAI,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE;gBACrC,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,CAAC,GAAG,KAAK;oBACzB,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;oBACzB,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;iBAChC,CAAC,CAAC;aACN;YACD,MAAM,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;SACzC;;QAED,MAAM,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;KACzC;CACJ,CAAC,CAAC"}