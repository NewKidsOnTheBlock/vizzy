{"version":3,"file":"app.js","sources":["src/app.js"],"sourcesContent":["//Grabbing our requirements from other files\nvar remote = require('electron').remote; // native electron module\nvar electronApp = require('electron').remote.app\nvar fs = require('fs');\nvar jetpack = require('fs-jetpack');\nvar d3 = require('d3');\nvar SvgSaver = require('../src/components/svgToPng.js').SvgSaver;\nconsole.log(SvgSaver);\n\n//Vue and its components\nvar Vue = require('vue/dist/vue.common.js');\nvar musicBar = require('../src/components/musicbar').musicBar;\n\n//Our three main classes\nvar Canvas = require('../src/components/canvas.js').Canvas;\nvar Shape = require('../src/components/shape.js').Shape;\nvar musicData = require('../src/components/musicdata.js').musicData;\n\n//Creating a global variable for a slash to append to our paths\nvar SLASH = (function() {\n        if(process.platform === 'darwin' || process.platform === 'linux') {\n            return '/';\n        }\n        else return '\\\\'\n})();\n\n//Path to our Vizzies\nvar VIZZY_PATH = electronApp.getPath('userData') + SLASH + 'vizzies';\n\n//Creating a function for Vue for swapping places\nVue.swap = function(arr, x, y) {\n   var origin = arr[x]\n   arr.splice(x, 1, arr[y])\n   Vue.set(arr, y, origin)\n}\n\nvar app = new Vue({\n    el: \".app\",\n    //These are all of the variables the application uses.\n    data: {\n        directoryCheck: jetpack.exists(VIZZY_PATH),\n        vizzyDirectory: '',\n        vizzies: [],\n        vizzy: {\n            id: \"Placeholder\",\n            canvas: new Canvas(),\n        },\n        musicInit: false,\n        state: {\n            home: true,\n            editor: false,\n            player: false,\n            sharing: false\n        },\n        popupState: {\n            deleting: false,\n            creating: false,\n            posting: false,\n            renaming: false,\n            saving: false,\n        },\n        selectedShape: {\n            shape: null,\n            typ: null,\n            pos: null,\n            or: null,\n            siz: null,\n            col: null,\n            minColor: null,\n            maxColor: null\n        },\n        editor: {\n            editId: false,\n            minColorSelected: true\n        },\n        newVizzyName: '',\n        shareMessage:'',\n        saveName:'',\n        existingViz:'',\n        tempVizzy:'',\n        shares: []\n    },\n    methods: {\n        //This is called from our music bar to make sure we have music loaded into our application\n        musicInitialize: function() {\n            this.musicInit = true;\n        },\n        //uses fetch API to update this.shares array for sharing feed\n        updateShareList: function(){\n            this.shares = [];\n            fetch('http://138.197.12.154:1729/api/posts',{\n                method: 'get'\n            }).then((res) => {\n                return res.json();\n            }).then((json) => {\n                this.shares = json;\n            })\n        },\n        //moves state to new View (page == v-if)\n        moveState: function(page, index) {\n            //Loop over our states and switch to the correct one\n            if(page === 'sharing'){\n                this.updateShareList();\n            }\n            for (var property in this.state) {\n                if (this.state.hasOwnProperty(property)) {\n                    if(property === page) {\n                        this.state[property] = true;\n                    }\n                    else {\n                        this.state[property] = false;\n                    }\n                }\n            }\n\n            var app = this;\n            //We have to set a timeout function here to make sure that the state has been switched\n            if(page === 'editor' || page === 'player') {\n                window.setTimeout(function() {\n                    //Reset our selected shape\n                    app.selectedShape = {\n                        shape: null,\n                        typ: null,\n                        pos: null,\n                        or: null,\n                        siz: null,\n                        col: null,\n                        minColor: null,\n                        maxColor: null\n                    };\n                    //If we are loading a saved vizzy\n                    if(index === 0 || index) {\n                        //Set our vizzy\n                        app.setVizzy(index);\n                    }\n                    //If we are loading a new vizzy\n                    else {\n                        app.setVizzy(null, true);\n                    }\n                },0);\n            }\n        },\n        //POSTs a vizzy to the Vizzy web API using XHR\n        shareVizzy: function(vizzy){\n\n            let req = new XMLHttpRequest();\n            req.open(\"POST\", \"http://138.197.12.154:1729/api/posts\");\n            req.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n            let params = \"message=\"+this.shareMessage+\"&vizzy=\"+JSON.stringify(this.posting);\n\n            //this function is asynchronously called upon req.response\n            req.onload = function(){\n                console.log(req.status);\n                console.log(req.response);\n            };\n\n            req.send(params);\n            this.popupState.posting=false;\n        },\n        //saves a vizzy from the sharing feed\n        saveShare: function(vizzy){\n            //parse shared vizzy to json, then write\n            Promise.resolve(JSON.parse(vizzy)).then((json) => {\n                let save = true;\n                for (let i=0; i<this.vizzies.length; i++){\n                    if (this.vizzies[i].id === json.id){\n                        //vizzy exists, don't save\n                        save = false;\n                        break;\n                    }\n                }\n                if (save){\n                    jetpack.write(VIZZY_PATH + SLASH + json.id + '.json', json);\n                    // //Update our vizzy list so it is reflected on the home page\n                    this.updateVizzyList();\n                    console.log(\"Saved vizzy \"+json.id+\"!\");\n                }\n                //if popup open, perform actions to save renamed vizzy\n                else if (this.popupState.saving){\n                    if(this.saveName.length > 0){\n                        json.id = this.saveName;\n                        jetpack.write(VIZZY_PATH + SLASH + json.id + '.json', json);\n                        this.updateVizzyList();\n                        this.existingViz = '';\n                        this.saveName = '';\n                        this.tempVizzy = '';\n                        this.popupState.saving = false;\n                    }\n                }\n                //prompt user (this.popupState.saving = true opens a popup)\n                else{\n                    console.log(\"saving true\");\n                    this.tempVizzy = vizzy;\n                    this.existingViz = json.id;\n                    this.popupState.saving = true;\n                }\n            });\n        },\n        playShare: function(vizzy){\n            this.saveShare(vizzy);\n            Promise.resolve(JSON.parse(vizzy)).then((json) => {\n                for (let i=0; i<this.vizzies.length; i++){\n                    if (this.vizzies[i].id === json.id){\n                        this.moveState('player', i);\n                        break;\n                    }\n                }\n            })\n\n        },\n        newVizzy: function() {\n            //Creates a new vizzy and moves to the editor\n            this.vizzy.id = this.newVizzyName || 'Placeholder' + this.vizzies.length;\n            this.moveState('editor');\n            this.newVizzyName = '';\n            this.popupState.creating = false;\n        },\n        saveVizzy: function() {\n            this.vizzy.pic = this.vizzy.canvas.domCanvas.toDataURL('png');\n            //Remove our existing file, and save the new one\n            jetpack.remove(VIZZY_PATH + SLASH + this.vizzy.id + '.json');\n            jetpack.write(VIZZY_PATH + SLASH + this.vizzy.id + '.json', this.vizzy);\n            //Update our vizzy list so it is reflected on the home page\n            this.updateVizzyList();\n            this.moveState('home');\n        },\n        //deletes selected vizzy, this.vizzy is determined by which box is clicked\n        deleteVizzy: function() {\n            //Remove our existing file, and save the new one\n            jetpack.remove(VIZZY_PATH + SLASH + this.deleting + '.json');\n            this.updateVizzyList();\n            this.popupState.deleting = false;\n        },\n        renameVizzy: function() {\n            jetpack.remove(VIZZY_PATH + SLASH + this.vizzies[this.popupState.renaming-1].id + '.json');\n            this.vizzies[this.popupState.renaming-1].id = this.newVizzyName;\n            jetpack.write(VIZZY_PATH + SLASH + this.newVizzyName + '.json', this.vizzies[this.popupState.renaming-1]);\n            this.newVizzyName = '';\n            this.updateVizzyList();\n            this.popupState.renaming = false;\n        },\n        setVizzy: function(index, newVizzy) {\n            //Create a new canvas, and set it's ID to our selected Vizzies ID\n            this.vizzy.canvas = new Canvas();\n\n            //Grabbing our on screen canvas, and resizing and setting the DOM of our canvas class\n            var canvas = document.getElementById('canvas');\n            canvas.width = canvas.clientWidth;\n            canvas.height = canvas.clientHeight;\n            //We also need to let our canvas class resize itself, and store the DOM canvas\n            this.vizzy.canvas.resize(canvas.clientWidth, canvas.clientHeight);\n            this.vizzy.canvas.setDomCanvas(canvas);\n\n            if (!newVizzy) {\n                this.vizzy.id = this.vizzies[index].id;\n                //Runs through all of the saved shapes and adds new shapes to our canvas. Also copies our saved shapes attributes to our new shapes\n                for(var i = 0; i < this.vizzies[index].canvas.shapes.length; i++) {\n                    this.vizzy.canvas.add();\n                    for (var property in this.vizzies[index].canvas.shapes[i]) {\n                        if (this.vizzies[index].canvas.shapes[i].hasOwnProperty(property)) {\n                            this.vizzy.canvas.shapes[i][property] = this.vizzies[index].canvas.shapes[i][property];\n                        }\n                    }\n                }\n            }\n        },\n        updateVizzyList: function() {\n            //Finds our stored vizzies and sets them to our vizzies array\n            var foundVizzies = jetpack.list(VIZZY_PATH);\n            var parsedVizzies = [];\n            if (foundVizzies.length === 0) {\n                console.log('no vizzies found');\n            }\n            else {\n                for(var i = 0; i < foundVizzies.length; i++) {\n                    parsedVizzies.push(JSON.parse(jetpack.read(VIZZY_PATH + SLASH + foundVizzies[i])));\n                }\n            }\n            this.vizzies = parsedVizzies;\n        },\n        resolvePic: function(vizzy) {\n            //This function is used to hand the picture of the Vizzy to the DOM\n            return 'url(' + vizzy.pic || '' + ')';\n        },\n        //Selects the shape in the editor\n        selectShape: function(index) {\n            this.selectedShape.shape = this.vizzy.canvas.shapes[index];\n            this.setColor();\n            for (var i = 0; i < this.vizzy.canvas.shapes.length; i++) {\n                this.vizzy.canvas.shapes[i].isSelected = false;\n            }\n            this.vizzy.canvas.shapes[index].isSelected = true;\n        },\n        deleteShape: function(index) {\n            this.vizzy.canvas.shapes.splice(index, 1);\n        },\n        //Moves a shape backwards in the editor\n        moveBack: function(index) {\n            this.selectedShape.shape = null;\n            if(index !== 0) {\n                Vue.swap(this.vizzy.canvas.shapes, index, index-1);\n            }\n\n        },\n        //Moves a shape forwards in the editor\n        moveForward: function(index) {\n            this.selectedShape.shape = null;\n            if(index !== this.vizzy.canvas.shapes.length - 1) {\n                Vue.swap(this.vizzy.canvas.shapes, index, index+1);\n                this.selectShape(index+1);\n            }\n            this.vizzy.canvas.rearrangeShapes();\n        },\n        //Used to toggle the shape editor panels\n        toggleShapePanel: function(type) {\n\n            if(this.selectedShape[type]) {\n                this.selectedShape[type] = null;\n            }\n            else {\n                this.selectedShape[type] = 'block';\n            }\n        },\n        //Used to add a new shape to a Vizzy\n        addShape: function() {\n            this.vizzy.canvas.add();\n        },\n        //Used to set the colors of the color selectors\n        setColor: function() {\n            var minRed = this.selectedShape.shape.minColor.red;\n            var minGreen = this.selectedShape.shape.minColor.green;\n            var minBlue = this.selectedShape.shape.minColor.blue;\n\n            this.selectedShape.minColor = \"rgb(\" + minRed + ',' + minGreen + ',' + minBlue + ')';\n\n            var maxRed = this.selectedShape.shape.maxColor.red;\n            var maxGreen = this.selectedShape.shape.maxColor.green;\n            var maxBlue = this.selectedShape.shape.maxColor.blue;\n\n            this.selectedShape.maxColor = \"rgb(\" + maxRed + ',' + maxGreen + ',' + maxBlue + ')';\n        }\n    },\n    //this function is called upon app init\n    mounted: function() {\n        //If we have a directory already created start Vizzy, otherwise create one\n        if (this.directoryCheck) {\n            this.updateVizzyList();\n        }\n        else {\n            jetpack.dir(VIZZY_PATH);\n            this.vizzyDirectory = VIZZY_PATH;\n        }\n\n        this.updateShareList();\n\n        //initialize audio context and create musicdata\n        var audioContext = new (window.AudioContext || window.webkitAudioContext)();\n        var mdata = new musicData(audioContext);\n\n        var app = this;\n\n        //This function is used to update the canvas when music is playing.\n        function refresh(){\n            //Only runs update if we are in the editor or play mode\n            if(app.state.editor || app.state.player) {\n                mdata.update().then((ret) => {\n                    app.vizzy.canvas.clear();\n                    app.vizzy.canvas.update(ret);\n                });\n            }\n            window.requestAnimationFrame(refresh);\n        }\n\n        window.requestAnimationFrame(refresh);\n    }\n});\n"],"names":[],"mappings":";;AAAA;AACA,IAAI,MAAM,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC;AACxC,IAAI,WAAW,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC,GAAG,CAAA;AAChD,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;AACvB,IAAI,OAAO,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACpC,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;AACvB,IAAI,QAAQ,GAAG,OAAO,CAAC,+BAA+B,CAAC,CAAC,QAAQ,CAAC;AACjE,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;;;AAGtB,IAAI,GAAG,GAAG,OAAO,CAAC,wBAAwB,CAAC,CAAC;AAC5C,IAAI,QAAQ,GAAG,OAAO,CAAC,4BAA4B,CAAC,CAAC,QAAQ,CAAC;;;AAG9D,IAAI,MAAM,GAAG,OAAO,CAAC,6BAA6B,CAAC,CAAC,MAAM,CAAC;AAC3D,IAAI,KAAK,GAAG,OAAO,CAAC,4BAA4B,CAAC,CAAC,KAAK,CAAC;AACxD,IAAI,SAAS,GAAG,OAAO,CAAC,gCAAgC,CAAC,CAAC,SAAS,CAAC;;;AAGpE,IAAI,KAAK,GAAG,CAAC,WAAW;QAChB,GAAG,OAAO,CAAC,QAAQ,KAAK,QAAQ,IAAI,OAAO,CAAC,QAAQ,KAAK,OAAO,EAAE;YAC9D,OAAO,GAAG,CAAC;SACd;aACI,OAAO,IAAI;CACvB,CAAC,EAAE,CAAC;;;AAGL,IAAI,UAAU,GAAG,WAAW,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,KAAK,GAAG,SAAS,CAAC;;;AAGrE,GAAG,CAAC,IAAI,GAAG,SAAS,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE;GAC5B,IAAI,MAAM,GAAG,GAAG,CAAC,CAAC,CAAC,CAAA;GACnB,GAAG,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;GACxB,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,EAAE,MAAM,CAAC,CAAA;CACzB,CAAA;;AAED,IAAI,GAAG,GAAG,IAAI,GAAG,CAAC;IACd,EAAE,EAAE,MAAM;;IAEV,IAAI,EAAE;QACF,cAAc,EAAE,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC;QAC1C,cAAc,EAAE,EAAE;QAClB,OAAO,EAAE,EAAE;QACX,KAAK,EAAE;YACH,EAAE,EAAE,aAAa;YACjB,MAAM,EAAE,IAAI,MAAM,EAAE;SACvB;QACD,SAAS,EAAE,KAAK;QAChB,KAAK,EAAE;YACH,IAAI,EAAE,IAAI;YACV,MAAM,EAAE,KAAK;YACb,MAAM,EAAE,KAAK;YACb,OAAO,EAAE,KAAK;SACjB;QACD,UAAU,EAAE;YACR,QAAQ,EAAE,KAAK;YACf,QAAQ,EAAE,KAAK;YACf,OAAO,EAAE,KAAK;YACd,QAAQ,EAAE,KAAK;YACf,MAAM,EAAE,KAAK;SAChB;QACD,aAAa,EAAE;YACX,KAAK,EAAE,IAAI;YACX,GAAG,EAAE,IAAI;YACT,GAAG,EAAE,IAAI;YACT,EAAE,EAAE,IAAI;YACR,GAAG,EAAE,IAAI;YACT,GAAG,EAAE,IAAI;YACT,QAAQ,EAAE,IAAI;YACd,QAAQ,EAAE,IAAI;SACjB;QACD,MAAM,EAAE;YACJ,MAAM,EAAE,KAAK;YACb,gBAAgB,EAAE,IAAI;SACzB;QACD,YAAY,EAAE,EAAE;QAChB,YAAY,CAAC,EAAE;QACf,QAAQ,CAAC,EAAE;QACX,WAAW,CAAC,EAAE;QACd,SAAS,CAAC,EAAE;QACZ,MAAM,EAAE,EAAE;KACb;IACD,OAAO,EAAE;;QAEL,eAAe,EAAE,WAAW;YACxB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;SACzB;;QAED,eAAe,EAAE,UAAU;YACvB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;YACjB,KAAK,CAAC,sCAAsC,CAAC;gBACzC,MAAM,EAAE,KAAK;aAChB,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,KAAK;gBACb,OAAO,GAAG,CAAC,IAAI,EAAE,CAAC;aACrB,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK;gBACd,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;aACtB,CAAC,CAAA;SACL;;QAED,SAAS,EAAE,SAAS,IAAI,EAAE,KAAK,EAAE;;YAE7B,GAAG,IAAI,KAAK,SAAS,CAAC;gBAClB,IAAI,CAAC,eAAe,EAAE,CAAC;aAC1B;YACD,KAAK,IAAI,QAAQ,IAAI,IAAI,CAAC,KAAK,EAAE;gBAC7B,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,CAAC,EAAE;oBACrC,GAAG,QAAQ,KAAK,IAAI,EAAE;wBAClB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC;qBAC/B;yBACI;wBACD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,KAAK,CAAC;qBAChC;iBACJ;aACJ;;YAED,IAAI,GAAG,GAAG,IAAI,CAAC;;YAEf,GAAG,IAAI,KAAK,QAAQ,IAAI,IAAI,KAAK,QAAQ,EAAE;gBACvC,MAAM,CAAC,UAAU,CAAC,WAAW;;oBAEzB,GAAG,CAAC,aAAa,GAAG;wBAChB,KAAK,EAAE,IAAI;wBACX,GAAG,EAAE,IAAI;wBACT,GAAG,EAAE,IAAI;wBACT,EAAE,EAAE,IAAI;wBACR,GAAG,EAAE,IAAI;wBACT,GAAG,EAAE,IAAI;wBACT,QAAQ,EAAE,IAAI;wBACd,QAAQ,EAAE,IAAI;qBACjB,CAAC;;oBAEF,GAAG,KAAK,KAAK,CAAC,IAAI,KAAK,EAAE;;wBAErB,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;qBACvB;;yBAEI;wBACD,GAAG,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;qBAC5B;iBACJ,CAAC,CAAC,CAAC,CAAC;aACR;SACJ;;QAED,UAAU,EAAE,SAAS,KAAK,CAAC;;YAEvB,IAAI,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;YAC/B,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,sCAAsC,CAAC,CAAC;YACzD,GAAG,CAAC,gBAAgB,CAAC,cAAc,EAAE,mCAAmC,CAAC,CAAC;YAC1E,IAAI,MAAM,GAAG,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;;YAGjF,GAAG,CAAC,MAAM,GAAG,UAAU;gBACnB,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBACxB,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;aAC7B,CAAC;;YAEF,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACjB,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,KAAK,CAAC;SACjC;;QAED,SAAS,EAAE,SAAS,KAAK,CAAC;;YAEtB,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK;gBAC9C,IAAI,IAAI,GAAG,IAAI,CAAC;gBAChB,KAAK,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC;oBACrC,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,IAAI,CAAC,EAAE,CAAC;;wBAE/B,IAAI,GAAG,KAAK,CAAC;wBACb,MAAM;qBACT;iBACJ;gBACD,IAAI,IAAI,CAAC;oBACL,OAAO,CAAC,KAAK,CAAC,UAAU,GAAG,KAAK,GAAG,IAAI,CAAC,EAAE,GAAG,OAAO,EAAE,IAAI,CAAC,CAAC;;oBAE5D,IAAI,CAAC,eAAe,EAAE,CAAC;oBACvB,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;iBAC3C;;qBAEI,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC;oBAC5B,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;wBACxB,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC;wBACxB,OAAO,CAAC,KAAK,CAAC,UAAU,GAAG,KAAK,GAAG,IAAI,CAAC,EAAE,GAAG,OAAO,EAAE,IAAI,CAAC,CAAC;wBAC5D,IAAI,CAAC,eAAe,EAAE,CAAC;wBACvB,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;wBACtB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;wBACnB,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;wBACpB,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,KAAK,CAAC;qBAClC;iBACJ;;oBAEG;oBACA,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;oBAC3B,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;oBACvB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,EAAE,CAAC;oBAC3B,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC;iBACjC;aACJ,CAAC,CAAC;SACN;QACD,SAAS,EAAE,SAAS,KAAK,CAAC;YACtB,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YACtB,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK;gBAC9C,KAAK,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC;oBACrC,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,IAAI,CAAC,EAAE,CAAC;wBAC/B,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;wBAC5B,MAAM;qBACT;iBACJ;aACJ,CAAC,CAAA;;SAEL;QACD,QAAQ,EAAE,WAAW;;YAEjB,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,IAAI,CAAC,YAAY,IAAI,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;YACzE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;YACzB,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;YACvB,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,KAAK,CAAC;SACpC;QACD,SAAS,EAAE,WAAW;YAClB,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;;YAE9D,OAAO,CAAC,MAAM,CAAC,UAAU,GAAG,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,OAAO,CAAC,CAAC;YAC7D,OAAO,CAAC,KAAK,CAAC,UAAU,GAAG,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;;YAExE,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;SAC1B;;QAED,WAAW,EAAE,WAAW;;YAEpB,OAAO,CAAC,MAAM,CAAC,UAAU,GAAG,KAAK,GAAG,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,CAAC;YAC7D,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,KAAK,CAAC;SACpC;QACD,WAAW,EAAE,WAAW;YACpB,OAAO,CAAC,MAAM,CAAC,UAAU,GAAG,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,OAAO,CAAC,CAAC;YAC3F,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,IAAI,CAAC,YAAY,CAAC;YAChE,OAAO,CAAC,KAAK,CAAC,UAAU,GAAG,KAAK,GAAG,IAAI,CAAC,YAAY,GAAG,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;YAC1G,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;YACvB,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,KAAK,CAAC;SACpC;QACD,QAAQ,EAAE,SAAS,KAAK,EAAE,QAAQ,EAAE;;YAEhC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,MAAM,EAAE,CAAC;;;YAGjC,IAAI,MAAM,GAAG,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;YAC/C,MAAM,CAAC,KAAK,GAAG,MAAM,CAAC,WAAW,CAAC;YAClC,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,YAAY,CAAC;;YAEpC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,WAAW,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;YAClE,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;;YAEvC,IAAI,CAAC,QAAQ,EAAE;gBACX,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC;;gBAEvC,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBAC9D,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;oBACxB,KAAK,IAAI,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;wBACvD,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,QAAQ,CAAC,EAAE;4BAC/D,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;yBAC1F;qBACJ;iBACJ;aACJ;SACJ;QACD,eAAe,EAAE,WAAW;;YAExB,IAAI,YAAY,GAAG,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAC5C,IAAI,aAAa,GAAG,EAAE,CAAC;YACvB,IAAI,YAAY,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC3B,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;aACnC;iBACI;gBACD,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBACzC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,GAAG,KAAK,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;iBACtF;aACJ;YACD,IAAI,CAAC,OAAO,GAAG,aAAa,CAAC;SAChC;QACD,UAAU,EAAE,SAAS,KAAK,EAAE;;YAExB,OAAO,MAAM,GAAG,KAAK,CAAC,GAAG,IAAI,EAAE,GAAG,GAAG,CAAC;SACzC;;QAED,WAAW,EAAE,SAAS,KAAK,EAAE;YACzB,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAC3D,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACtD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,UAAU,GAAG,KAAK,CAAC;aAClD;YACD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC;SACrD;QACD,WAAW,EAAE,SAAS,KAAK,EAAE;YACzB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;SAC7C;;QAED,QAAQ,EAAE,SAAS,KAAK,EAAE;YACtB,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,IAAI,CAAC;YAChC,GAAG,KAAK,KAAK,CAAC,EAAE;gBACZ,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;aACtD;;SAEJ;;QAED,WAAW,EAAE,SAAS,KAAK,EAAE;YACzB,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,IAAI,CAAC;YAChC,GAAG,KAAK,KAAK,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC9C,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;gBACnD,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;aAC7B;YACD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC;SACvC;;QAED,gBAAgB,EAAE,SAAS,IAAI,EAAE;;YAE7B,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE;gBACzB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;aACnC;iBACI;gBACD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;aACtC;SACJ;;QAED,QAAQ,EAAE,WAAW;YACjB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;SAC3B;;QAED,QAAQ,EAAE,WAAW;YACjB,IAAI,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC;YACnD,IAAI,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC;YACvD,IAAI,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC;;YAErD,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,MAAM,GAAG,MAAM,GAAG,GAAG,GAAG,QAAQ,GAAG,GAAG,GAAG,OAAO,GAAG,GAAG,CAAC;;YAErF,IAAI,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC;YACnD,IAAI,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC;YACvD,IAAI,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC;;YAErD,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,MAAM,GAAG,MAAM,GAAG,GAAG,GAAG,QAAQ,GAAG,GAAG,GAAG,OAAO,GAAG,GAAG,CAAC;SACxF;KACJ;;IAED,OAAO,EAAE,WAAW;;QAEhB,IAAI,IAAI,CAAC,cAAc,EAAE;YACrB,IAAI,CAAC,eAAe,EAAE,CAAC;SAC1B;aACI;YACD,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;YACxB,IAAI,CAAC,cAAc,GAAG,UAAU,CAAC;SACpC;;QAED,IAAI,CAAC,eAAe,EAAE,CAAC;;;QAGvB,IAAI,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,kBAAkB,CAAC,EAAE,CAAC;QAC5E,IAAI,KAAK,GAAG,IAAI,SAAS,CAAC,YAAY,CAAC,CAAC;;QAExC,IAAI,GAAG,GAAG,IAAI,CAAC;;;QAGf,SAAS,OAAO,EAAE;;YAEd,GAAG,GAAG,CAAC,KAAK,CAAC,MAAM,IAAI,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE;gBACrC,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,CAAC,GAAG,KAAK;oBACzB,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;oBACzB,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;iBAChC,CAAC,CAAC;aACN;YACD,MAAM,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;SACzC;;QAED,MAAM,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;KACzC;CACJ,CAAC,CAAC"}